Import des librairies nécessaires
```{r}
library(tidyverse)
library(compositions)
library(factoextra)
library(FactoMineR)
```

Import du dataset
```{r}
df <- read.csv("dataset.csv")

```

Résumé du dataset
```{r}
str(df)
summary(df)
```

Analyse univariée
```{r}
df %>%
  select_if(is.numeric) %>%
  gather() %>%
  ggplot(aes(value)) +
  geom_histogram(bins = 30) +
  facet_wrap(~ key, scales = 'free') +
  theme_minimal()
```
Analyse bivariée 
```{r}
# Matrice de corrélation
correlation_matrix <- cor(df %>% select_if(is.numeric))
corrplot::corrplot(correlation_matrix, method = "circle")
```
```{r}
# Scatter plots pour les variables numériques
ggplot(df, aes(x = TxPauv, y = txabs)) +
  geom_point() +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Relation entre le taux de pauvreté et le taux d'abstention")

```
Variables descriptives
```{r}
# Nombre de variables descriptives
descriptive_vars <- df %>% select_if(is.numeric) %>% colnames()
length(descriptive_vars)  # Nombre de variables

# Vérification des données compositionnelles
# Vous devrez définir quelles colonnes sont compositionnelles (par exemple, proportions)
compositionnal_vars <- c("Ouvrier", "Employe", "Cadres", "Artisant", "Agri")  # Exemple

```
```{r}
# PCA
pca_result <- prcomp(df %>% select_if(is.numeric), scale. = TRUE)
summary(pca_result)

# Visualisation des résultats PCA
biplot(pca_result)
```
PC1 est la composante la plus importante, expliquant une grande partie de la variance dans vos données.
PC2 et PC3 sont également significatifs mais expliquent beaucoup moins de variance.

```{r}
# Supprimer les colonnes non pertinentes
df_clean <- df[, !colnames(df) %in% c("X", "Department", "Code")]
```


```{r}
data_acp <- scale(df_clean[sapply(df_clean, is.numeric)])
result_acp <- PCA(df_clean, scale.unit = TRUE, ncp = 5, graph = FALSE)

fviz_screeplot(result_acp)
fviz_pca_var(result_acp)
fviz_pca_ind(result_acp)
```

```{r}
# Préparer le dataset : sélectionner les colonnes pertinentes et ignorer celles qui n'ont pas de valeur ajoutée
df_acm <- df %>%
  select(-c(Department, Code))

# Assurez-vous que les colonnes de votre dataset sont de type facteur si nécessaire
df_acm <- df_acm %>%
  mutate(across(everything(), as.factor))

# Réaliser l'ACM
acm_result <- MCA(df_acm, graph = FALSE)

# Visualiser les résultats de l'ACM avec des ajustements
fviz_mca_biplot(acm_result, 
                 repel = TRUE,        # Évite le chevauchement des étiquettes
                 geom.ind = "point",  # Utilise des points pour les individus
                 geom.var = "arrow",   # Utilise des flèches pour les variables
                 label = "none",       # N'affiche pas les labels
                 pointsize = 2,        # Taille des points
                 col.var = "cos2",     # Couleur des flèches en fonction de la qualité de représentation
                 gradient.cols = "RdYlBu") +  # Choix des couleurs
  labs(title = "Analyse en Composantes Multiples (ACM)", 
       x = "Dim 1", 
       y = "Dim 2") +
  theme_minimal() +
  theme(legend.position = "bottom")  # Position de la légende
```


